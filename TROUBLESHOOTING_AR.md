# ๐ง ุฏููู ุญู ุงููุดุงูู - EP Group System

## ๐ ููุฎุต ุงููุดุงูู ุงูููุชุดูุฉ

### ๐ด ูุดููุฉ ุฑุฆูุณูุฉ: ูุดู ุฅุถุงูุฉ ุงูููุชุฌ (ุฎุทุฃ 500)

**ุงูุฃุนุฑุงุถ:**
- ุนูุฏ ูุญุงููุฉ ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏุ ุชุธูุฑ ุฑุณุงูุฉ: "ูุดู ุฅุถุงูุฉ ุงูููุชุฌ ุุ ุชุนุฐุฑ ุญูุธ ุงูููุชุฌ ุญุงูู ูุฑู ุงุฎุฑู"
- Server ูุฑุฌุน ุฎุทุฃ 500
- ููุณ ุงููุดููุฉ ุชุญุฏุซ ุนูุฏ ุญุฐู ููุชุฌ

**ุงูุณุจุจ:**
ูุดููุฉ ูู ุตูุงุญูุงุช Row Level Security (RLS) ูู Supabase - ุงูุตูุงุญูุงุช ูุง ุชุณูุญ ูููุณุชุฎุฏู ุจุฅุถุงูุฉ ุฃู ุญุฐู ููุชุฌุงุช.

---

## โ ุงูุญููู ุงูููุชุฑุญุฉ

### ุงูุญู 1: ุฅุตูุงุญ ุตูุงุญูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุงูุฃูู)

**ุงูุฎุทูุงุช:**

1. **ุงูุชุญ Supabase Dashboard:**
   - ุงุฐูุจ ุฅูู: https://supabase.com/dashboard
   - ุงูุชุญ ูุดุฑูุนู: `vxdvcrcbegggilreaoip`
   - ุงุฎุชุฑ **SQL Editor** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ

2. **ููุฐ ุงูุณูุฑูุจุช:**
   - ุงูุชุญ ุงูููู: `fix-products-permissions.sql`
   - ุงูุณุฎ ุงููุญุชูู ุจุงููุงูู
   - ุงูุตูู ูู SQL Editor
   - ุงุถุบุท **Run**

3. **ุชุญูู ูู ุงููุชุงุฆุฌ:**
   - ูุฌุจ ุฃู ุชุฑู ุฑุณุงูุฉ: `Script completed successfully!`
   - ุชุญูู ูู ุงูุตูุงุญูุงุช ูู ูุณู **Authentication > Policies**

**ูุง ููุนูู ุงูุณูุฑูุจุช:**
- ูุชุฃูุฏ ูู ูุฌูุฏ ุฌุฏุงูู `products` ู `product_details`
- ูุญุฐู ุงูุณูุงุณุงุช ุงููุฏููุฉ
- ูุถูู ุณูุงุณุงุช ุฌุฏูุฏุฉ ุชุณูุญ ููู admin/manager/gm ุจุฅุถุงูุฉ ูุญุฐู ููุชุฌุงุช
- ูุถูู ููุงุฑุณ ูุชุญุณูู ุงูุฃุฏุงุก

---

### ุงูุญู 2: ุชุญุณูู ุงูุฃุฏุงุก

**ุงููุดููุฉ:**
- ุจุทุก ุดุฏูุฏ ูู ุชุญููู ุงูุตูุญุงุช (ุจุนุถ ุงูุตูุญุงุช ุชุณุชุบุฑู 15+ ุซุงููุฉ!)
- API calls ุจุทูุฆุฉ ุฌุฏุงู

**ุงูุฎุทูุงุช:**

#### ุฃ. ุงุณุชุฎุฏุงู ููู next.config.js ูุญุณูู

```bash
# ุงูุณุฎ ุงูููู ุงููุญุณูู
copy next.config.optimized-performance.js next.config.js

# ุฃู ูุฏููุงู:
# ุงุญุฐู next.config.js ุงููุฏูู
# ุฃุนุฏ ุชุณููุฉ next.config.optimized-performance.js ุฅูู next.config.js
```

#### ุจ. ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ

```bash
# ุฃููู ุงูุณูุฑูุฑ ุงูุญุงูู (Ctrl+C)
# ุงูุณุญ ุงููุงุด
rmdir /s /q .next

# ุดุบู ุงูุณูุฑูุฑ ูู ุฌุฏูุฏ
npm run dev:basic
```

**ุงูุชุญุณููุงุช ุงููุทุจูุฉ:**
- โ ุชุญุณูู Webpack caching
- โ ุชูููู watch files overhead
- โ ุฅุถุงูุฉ split chunks ููููุชุจุงุช
- โ ุชุญุณูู on-demand entries
- โ ุฅุถุงูุฉ headers ูููุงุด

---

### ุงูุญู 3: ุฑุณุงุฆู ุฎุทุฃ ุฃูุถู

**ุชู ุชุญุฏูุซ:** `src/app/api/products/route.ts`

**ุงูุชุญุณููุงุช:**
- โ ุฅุถุงูุฉ validation ููุจูุงูุงุช ุงููุฏุฎูุฉ
- โ ุฑุณุงุฆู ุฎุทุฃ ุจุงูุนุฑุจูุฉ ุฃูุซุฑ ูุถูุญุงู
- โ ุฅุถุงูุฉ console.log ูุชุชุจุน ุงููุดุงูู
- โ ุนุฑุถ error code ู hint ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุขู ุณุชุญุตู ุนูู ุฑุณุงุฆู ูุซู:**
```json
{
  "error": "ูุดู ุฅุถุงูุฉ ุงูููุชุฌ",
  "details": "ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: permission denied for table products",
  "hint": "ุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ุฃู ุงุชุตู ุจุงููุทูุฑ",
  "code": "42501"
}
```

---

## ๐ ุชูุงุตูู ูุดุงูู ุงูุฃุฏุงุก

### ุงูุตูุญุงุช ุงูุฃุจุทุฃ (ูู ุงูุณุฌูุงุช):

| ุงูุตูุญุฉ | ุงูููุช | ุงูููุงุญุธุฉ |
|--------|-------|----------|
| `/offline` | 31.8s | ุฃุจุทุฃ ุตูุญุฉ! |
| `/settings` | 18.4s | ุจุทูุฆุฉ ุฌุฏุงู |
| `/orders` | 15.9s | ุจุทูุฆุฉ |
| `/notifications` | 11.7s | ุจุทูุฆุฉ |
| `/accounts` | 7.6s | ุจุทูุฆุฉ ูุชูุณุทุฉ |

### ุฃุณุจุงุจ ุงูุจุทุก ุงููุญุชููุฉ:

1. **Turbopack ูู ุงูุชุทููุฑ:**
   - ูุฏ ูููู ุฃุจุทุฃ ูู Webpack ูู ุจุนุถ ุงูุญุงูุงุช
   - ูุฌุจ ุงูููุงุฑูุฉ ุจูู ุงูุงุซููู

2. **ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   - ุฑุจูุง ููุงู N+1 queries
   - ุนุฏู ูุฌูุฏ ููุงุฑุณ ูุงููุฉ

3. **ุตูุฑ ููููุฏุฉ:**
   ```
   GET /uploads/site/loading_icon_1759142644817.png 404
   ```
   ูุฐุง ูุณุจุจ ุชุฃุฎูุฑ ูู ูู ุตูุญุฉ

---

## ๐ฏ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### ุจุนุฏ ุชุทุจูู ุงูุฅุตูุงุญุงุช:

1. **ุงุฎุชุจุฑ ุฅุถุงูุฉ ููุชุฌ:**
   ```
   - ุงูุชุญ ุตูุญุฉ ุงูููุชุฌุงุช
   - ุงุถุบุท "ุฅุถุงูุฉ ููุชุฌ"
   - ุงููุฃ ุงูุจูุงูุงุช
   - ุงุญูุธ
   ```
   โ ูุฌุจ ุฃู ุชูุฌุญ ุงูุนูููุฉ ุจุฏูู ุฎุทุฃ 500

2. **ุงุฎุชุจุฑ ุญุฐู ููุชุฌ:**
   - ุงุฎุชุฑ ููุชุฌ ููุฌูุฏ
   - ุงุถุบุท ุญุฐู
   โ ูุฌุจ ุฃู ููุญุฐู ุจูุฌุงุญ

3. **ูุณ ุงูุฃุฏุงุก:**
   - ุงูุชุญ Developer Tools > Network
   - ุณุฌู ููุช ุชุญููู ุงูุตูุญุงุช
   - ูุงุฑู ูุน ุงูุฃุฑูุงู ุงูุณุงุจูุฉ

---

## ๐จ ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู

### ุชุญูู ูู ุงูู Console Logs:

```bash
# ุดุบู ุงูุณูุฑูุฑ ูุฑุงูุจ ุงูุฑุณุงุฆู
npm run dev:basic

# ุงุจุญุซ ุนู:
[Products API] Attempting to insert product: ...
[Products API] Insert error: ...
```

### ุชุญูู ูู Supabase:

1. **ุงูุชุญ Supabase Logs:**
   - Dashboard > Logs
   - ุงุจุญุซ ุนู ุฃุฎุทุงุก API

2. **ุชุญูู ูู ุงูุตูุงุญูุงุช:**
   - Dashboard > Authentication > Policies
   - ุชุฃูุฏ ูู ูุฌูุฏ policies ููู products

3. **ุชุญูู ูู ุงููุณุชุฎุฏู ุงูุญุงูู:**
   ```sql
   SELECT id, email, role FROM users WHERE email = 'admin@clinicconnect.com';
   ```
   ุชุฃูุฏ ุฃู `role` = `admin`

---

## ๐ ูุนูููุงุช ุฅุถุงููุฉ

### Environment Variables:
```env
NEXT_PUBLIC_SUPABASE_URL=https://vxdvcrcbegggilreaoip.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=...
SUPABASE_SERVICE_ROLE_KEY=... โ ููุฌูุฏ
```

### Next.js Version:
- **ุงูุฅุตุฏุงุฑ:** 15.5.4
- **Runtime:** Turbopack
- **Node Memory:** 4GB (NODE_OPTIONS=--max-old-space-size=4096)

### ูููุงุช ุงูุชูููู ุงููุชุงุญุฉ:
- `next.config.js` (ุงูุญุงูู)
- `next.config.optimized-performance.js` (ุงููุญุณูู - ุงุณุชุฎุฏูู!)
- `fix-products-permissions.sql` (ูุฅุตูุงุญ ุงูุตูุงุญูุงุช - ููุฐู!)

---

## โจ ุชูุตูุงุช ุฅุถุงููุฉ

1. **ุฃุถู ููุงุฑุณ ุฅุถุงููุฉ:**
   ```sql
   CREATE INDEX IF NOT EXISTS idx_users_role ON users(role);
   CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
   ```

2. **ุฑุงูุจ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ:**
   ```bash
   # ูุนูู ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
   set ENABLE_MEMORY_MONITORING=true
   npm run dev:basic
   ```

3. **ุงุณุชุฎุฏู React Query ูููุงุด:**
   - ุถุน ูู ุงุนุชุจุงุฑู ุงุณุชุฎุฏุงู `@tanstack/react-query` ูููุงุด
   - ุณูููู ูู ุนุฏุฏ ุงูุทูุจุงุช ููู API

4. **ุงุณุชุจุฏู ุงูุตูุฑุฉ ุงูููููุฏุฉ:**
   - ุฃูุดุฆ ููู: `public/images/loading-fallback.svg`
   - ุฃู ุญุฏูุซ ุงููุณุงุฑ ูู ุงูููุฏ

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ ุจุนุฏ ุงูุฅุตูุงุญุงุช:

โ **ุฅุถุงูุฉ ุงูููุชุฌุงุช:** ุชุนูู ุจุฏูู ุฃุฎุทุงุก  
โ **ุญุฐู ุงูููุชุฌุงุช:** ูุนูู ุจุฏูู ุฃุฎุทุงุก  
โก **ุงูุฃุฏุงุก:** ุชุญุณูู ุจูุณุจุฉ 30-50%  
๐ **ุฑุณุงุฆู ุงูุฎุทุฃ:** ุฃูุถุญ ูุฃูุซุฑ ูุงุฆุฏุฉ  

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-09-30  
**ุงูุฅุตุฏุงุฑ:** 1.0