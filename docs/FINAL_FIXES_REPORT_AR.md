# ๐ฏ ุงูุชูุฑูุฑ ุงูุดุงูู: ุฅุตูุงุญ ูุดุงูู ุงููุธุงู ูู ุงูุฌุฐูุฑ

> **ุชูุฑูุฑ ููุงุฆู - ุจุงูุนุงููุฉ ุงูุจุณูุทุฉ**  
> ุชุงุฑูุฎ: 2024  
> ุงููุธุงู: EP Group Management System

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ุงููุดุงูู ุงููู ูุงูุช ููุฌูุฏุฉ](#-ุงููุดุงูู-ุงููู-ูุงูุช-ููุฌูุฏุฉ)
2. [ููู ุงููุดุงูู ุฏู ูุงูุช ุฎุทูุฑุฉุ](#-ููู-ุงููุดุงูู-ุฏู-ูุงูุช-ุฎุทูุฑุฉ)
3. [ุงูุญููู ุงููู ุงุชุนููุช](#-ุงูุญููู-ุงููู-ุงุชุนููุช)
4. [ุทุฑููุฉ ุชุดุบูู ุงูุญููู](#-ุทุฑููุฉ-ุชุดุบูู-ุงูุญููู)
5. [ุงูุฎุทูุงุช ุงูุฌุงูุฉ](#-ุงูุฎุทูุงุช-ุงูุฌุงูุฉ)

---

## ๐ ุงููุดุงูู ุงููู ูุงูุช ููุฌูุฏุฉ

### 1๏ธโฃ ูุดููุฉ **ุงูุจูุงูุงุช ุงูุบูุท** (Data Validation)

**ุฅูู ุงููู ูุงู ุจูุญุตูุ**
- ุฃู ุญุฏ ููุฏุฑ ูุจุนุช ุฃู ุจูุงูุงุช ููุณูุฑูุฑุ ุญุชู ูู ุบูุท
- ูุซูุงู: ูุนูู Order ุจุฏูู ุงุณู ุนูููุ ุฃู ูุญุท ุฑูู ุชููููู ููู ุญุฑูู
- ุงููุธุงู ูุงู ุจูุงุฎุฏ ุงูุจูุงูุงุช ุฏู ููุญุทูุง ูู ุงูุฏุงุชุงุจูุฒ ูู ุบูุฑ ูุง ูุดูู ุนูููุง

**ุงููุดููุฉ ุงูุญููููุฉ:**
```
ุงููุณุชุฎุฏู โ ูุจุนุช ุจูุงูุงุช ุบูุท โ ุงูุณูุฑูุฑ ููุจููุง โ ุงูุฏุงุชุงุจูุฒ ุชุฎุฒููุง 
โ ุงููุธุงู ูุจูุธ! โ
```

**ูุชูุฌุฉ ุงููุดููุฉ:**
- ุจูุงูุงุช ูุงุณุฏุฉ ูู ุงูุฏุงุชุงุจูุฒ
- ุงูุฃูุฑุฏุฑุงุช ุชุชุนูู ุจุฏูู ูุนูููุงุช ูููุฉ
- ุชูุงุฑูุฑ ุบูุท
- ุงููุธุงู ูุด ููุซูู ููู

---

### 2๏ธโฃ ูุดููุฉ **ุงููุฎุฒูู ุจูุฎูุต** (Stock Management)

**ุฅูู ุงููู ูุงู ุจูุญุตูุ**
- ุงููุธุงู ูุงู ุจูุณูุญ ุจุนูู ุฃูุฑุฏุฑุงุช ุญุชู ูู ุงูููุชุฌ ุฎูุต ูู ุงููุฎุฒูู
- ูุซุงู: ุนูุฏู 5 ูุทุน ุจุณ ูู ููุชุฌุ ูุงููุธุงู ููุจู 10 ุฃูุฑุฏุฑุงุช ูู ููุณ ุงูููุช!
- ูู ูุงุญุฏ ูุดูู ุฅู ุงูููุชุฌ ูุชุงุญุ ุงููู ูุทูุจุ ูุจุนุฏูู ุชูุชุดู ุฅู ุงููุฎุฒูู ุณุงูุจ ๐ฑ

**ุงููุดููุฉ ุงูุญููููุฉ:**
```
User 1: ุดุงู ุงูููุชุฌ ูุชููุฑ (5 ูุทุน) โ ุทูุจ 3 ูุทุน
User 2: ุดุงู ุงูููุชุฌ ูุชููุฑ (5 ูุทุน) โ ุทูุจ 4 ูุทุน
ุงููุชูุฌุฉ: ุงุชุทูุจ 7 ูุทุน ูุงููุฎุฒูู 5 ุจุณ! โ
```

**ูุชูุฌุฉ ุงููุดููุฉ:**
- ุนููุงุก ูุทูุจูุง ููุชุฌุงุช ูุด ููุฌูุฏุฉ
- ุงููุฎุฒูู ูุจูู ุณุงูุจ (ูุซูุงู: -3 ูุทุนุฉ!)
- ุงูููุธููู ูุชูุฎุจุทูุง ูู ุงูุดุบู
- ุณูุนุฉ ุงูุดุฑูุฉ ุชุชุฃุซุฑ

---

### 3๏ธโฃ ูุดููุฉ **ุงูุฃุฎุทุงุก ูุด ูุงุถุญุฉ** (Error Handling)

**ุฅูู ุงููู ูุงู ุจูุญุตูุ**
- ููุง ุญุงุฌุฉ ุชุจูุธุ ุงููุธุงู ูุทูุน ุฑุณุงูุฉ ุฒู: `Error 500` ุฃู `undefined`
- ุงููุณุชุฎุฏู ูุด ูุงูู ุฅูู ุงููุดููุฉ
- ุงูุฏููููุจุฑ ููุงู ูุด ุนุงุฑู ุฅูู ุงููู ุญุตู

**ุงููุดููุฉ ุงูุญููููุฉ:**
```
ุญุตู ุฎุทุฃ โ ุงููุธุงู ููุณุฑ โ ุฑุณุงูุฉ ุบุฑูุจุฉ โ ุงููุณุชุฎุฏู confused โ
```

**ูุชูุฌุฉ ุงููุดููุฉ:**
- ุตุนูุจุฉ ูู ูุนุฑูุฉ ุณุจุจ ุงููุดุงูู
- ููุช ุทููู ูู ุงูู debugging
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุฆุฉ ุฌุฏุงู

---

### 4๏ธโฃ ูุดููุฉ **Race Conditions** (ุชุนุงุฑุถ ุงูุนูููุงุช ุงููุชุฒุงููุฉ)

**ุฅูู ุงููู ูุงู ุจูุญุตูุ**
- ูู ูุณุชุฎุฏููู ุงุชููู ูุชุญูุง ููุณ ุงูุฃูุฑุฏุฑ ูู ููุณ ุงูููุช
- ูู ูุงุญุฏ ูุนุฏู ููู
- ุงูุชุนุฏููุงุช ุชุชุถุงุฑุจ ูุน ุจุนุถ
- ูุงุญุฏ ูููู ุชุนุฏููุงุชู ุชุถูุน!

**ุงููุดููุฉ ุงูุญููููุฉ:**
```
User A: ูุชุญ Order #123 โ ุนุฏู ุงูุญุงูุฉ ูู "completed"
User B: ูุชุญ Order #123 โ ุนุฏู ุงูุญุงูุฉ ูู "cancelled"
ุงููุชูุฌุฉ: ุชุนุฏููุงุช User A ุฑุงุญุช! โ
```

**ูุชูุฌุฉ ุงููุดููุฉ:**
- ุจูุงูุงุช ุชุถูุน
- ุชุนุฏููุงุช ุชุชูุณุญ
- ุญุงูุฉ ุงูุทูุจุงุช ุชุจูู ุบูุท

---

## ๐ฅ ููู ุงููุดุงูู ุฏู ูุงูุช ุฎุทูุฑุฉุ

### ุชุฃุซูุฑ ุนูู **ุงูุฃุนูุงู** (Business Impact):
- โ **ุฎุณุงุฑุฉ ูุงููุฉ**: ุทูุจุงุช ุจุชุชุนูู ูููุชุฌุงุช ูุด ููุฌูุฏุฉ
- โ **ุณูุนุฉ ุณูุฆุฉ**: ุงูุนููุงุก ูุด ุฑุงุถููู
- โ **ุถูุงุน ููุช**: ุงูููุธููู ุจูุตุฑููุง ููุช ูุญููุง ุงููุดุงูู ูุฏูู

### ุชุฃุซูุฑ ุนูู **ุงูุชูููุฉ** (Technical Impact):
- โ **ุจูุงูุงุช ุบูุฑ ููุซููุฉ**: ููููุนุด ุชุนุชูุฏ ุนูู ุงูุชูุงุฑูุฑ
- โ **ุตุนูุจุฉ ุงูุตูุงูุฉ**: ูู ุดููุฉ ูุดููุฉ ุฌุฏูุฏุฉ
- โ **ุฃูุงู ุถุนูู**: ุฃู ุญุฏ ููุฏุฑ ูุจุนุช ุฃู ุญุงุฌุฉ

---

## โ ุงูุญููู ุงููู ุงุชุนููุช

### ๐ก๏ธ ุงูุญู 1: ูุธุงู ุชุญูู ูู ุงูุจูุงูุงุช (Validation System)

**ุงููููุงุช ุงููููุดุฃุฉ:**
- `src/lib/validation/schemas.ts` - ููุงุนุฏ ุงูุชุญูู ูู ุงูุจูุงูุงุช
- `src/lib/validation/stock-validator.ts` - ุงูุชุญูู ูู ุงููุฎุฒูู

**ุฅูู ุงููู ุจูุนูููุ**
```typescript
// ูุจู: ุฃู ุจูุงูุงุช ุชุนุฏู
const order = { name: "", phone: "abc" }; // โ ููุจู ุงูุบูุท

// ุจุนุฏ: ุงูุชุญูู ุงูุฃูุชููุงุชููู
const order = orderSchema.parse({
  customerName: "", // โ Error: ุงูุงุณู ูุทููุจ
  phone: "abc"      // โ Error: ุฑูู ุชููููู ุบูุท
}); 
```

**ุงูููุงุฆุฏ:**
- โ ููุน ุฅุฏุฎุงู ุจูุงูุงุช ุบูุท **ูุจู** ูุง ุชูุตู ููุฏุงุชุงุจูุฒ
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููููุฉ
- โ ุญูุงูุฉ ุงูุฏุงุชุงุจูุฒ ูู ุงูุจูุงูุงุช ุงููุงุณุฏุฉ
- โ ุชูููุฑ ููุช debugging

---

### ๐ ุงูุญู 2: ุญูุงูุฉ ุงููุฎุฒูู (Stock Protection)

**ุงููููุงุช ุงููููุดุฃุฉ:**
- `src/lib/validation/stock-validator.ts`

**ุฅูู ุงููู ุจูุนูููุ**
```typescript
// ูุจู ุฅูุดุงุก ุฃู Orderุ ูุดูู ุนูู ุงููุฎุฒูู
await validateStockOrThrow([
  { productId: "123", quantity: 10 }
]);

// ูู ุงููุฎุฒูู ูุด ูุงูู โ โ ูุฑูุถ ุงูุทูุจ
// ูู ุงููุฎุฒูู ูุงูู โ โ ูููู ุงูุทูุจ ููุฎุตู
```

**ุงูุญูุงูุฉ:**
1. **ูุจู ุงูุทูุจ**: ุงูุชุญูู ูู ุชููุฑ ุงูููุชุฌ
2. **ุฃุซูุงุก ุงูุทูุจ**: ููู ุงูููุชุฌ (Lock) ูุญุฏ ูุง ุงูุทูุจ ูุฎูุต
3. **ุจุนุฏ ุงูุทูุจ**: ุชุญุฏูุซ ุงููุฎุฒูู ุจุดูู ุขูู

**ุงูููุงุฆุฏ:**
- โ **ูุณุชุญูู** ูุชุนูู ุทูุจ ูููุชุฌ ุฎูุต
- โ ุชุญุฐูุฑุงุช ููุง ุงููุฎุฒูู ููุฑุจ ูุฎูุต
- โ ููุน ุงูุณุงูุจ ูู ุงููุฎุฒูู
- โ ุชูุงุฑูุฑ ุฏูููุฉ

---

### ๐จ ุงูุญู 3: ูุธุงู ุงูุฃุฎุทุงุก ุงูุงุญุชุฑุงูู (Error System)

**ุงููููุงุช ุงููููุดุฃุฉ:**
- `src/lib/errors/app-errors.ts` - ุฃููุงุน ุงูุฃุฎุทุงุก
- `src/lib/errors/error-handler.ts` - ูุนุงูุฌ ุงูุฃุฎุทุงุก

**ุฅูู ุงููู ุจูุนูููุ**

**ูุจู ุงูุญู:**
```
โ Error 500
โ undefined
โ Something went wrong
```

**ุจุนุฏ ุงูุญู:**
```
โ "ูุฎุฒูู ุบูุฑ ูุงูู: ููุชุฌ XYZ - ูุชููุฑ: 3ุ ูุทููุจ: 5"
โ "ุฑูู ุงูุชููููู ุบูุฑ ุตุญูุญ: ูุฌุจ ุฃู ูููู 11 ุฑูู"
โ "ุงูุทูุจ #123 ุบูุฑ ููุฌูุฏ"
```

**ุฃููุงุน ุงูุฃุฎุทุงุก:**
- `ValidationError` - ุฎุทุฃ ูู ุงูุจูุงูุงุช ุงูููุฏุฎูุฉ
- `NotFoundError` - ุงูุณุฌู ุบูุฑ ููุฌูุฏ
- `UnauthorizedError` - ุงููุณุชุฎุฏู ุบูุฑ ูุตุฑุญ ูู
- `StockError` - ูุดููุฉ ูู ุงููุฎุฒูู
- `DatabaseError` - ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูููุงุฆุฏ:**
- โ ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
- โ ูุนูููุงุช ุชูุตูููุฉ ููุฏููููุจุฑ
- โ logging ุชููุงุฆู ููุฃุฎุทุงุก
- โ ุณูููุฉ ูู ุงูู debugging

---

### โก ุงูุญู 4: ุงููุนุงููุงุช ุงูุขููุฉ (Transactions)

**ุงููููุงุช ุงููููุดุฃุฉ:**
- `src/lib/db/transaction-helper.ts`

**ุฅูู ุงููู ุจูุนูููุ**

**ุงูุณููุงุฑูู: ุฅูุดุงุก ุฃูุฑุฏุฑ ุฌุฏูุฏ**

**ูุจู ุงูุญู:**
```typescript
// ุฎุทูุฉ 1: ุฅูุดุงุก Order
const order = await createOrder(); // โ ูุฌุญ

// ุฎุทูุฉ 2: ุฎุตู ุงููุฎุฒูู
const stock = await updateStock(); // โ ูุดู!

// ุงููุชูุฌุฉ: Order ุงุชุนูู ุจุณ ุงููุฎุฒูู ูุงุชุฎุตูุด! ๐ฅ
```

**ุจุนุฏ ุงูุญู:**
```typescript
await runInTransaction(async (client) => {
  // ูู ุงูุฎุทูุงุช ูู ูุนุงููุฉ ูุงุญุฏุฉ
  const order = await createOrder();      // ุฎุทูุฉ 1
  const stock = await updateStock();      // ุฎุทูุฉ 2
  const invoice = await createInvoice();  // ุฎุทูุฉ 3
  
  // ูู ุฃู ุฎุทูุฉ ูุดูุช โ ูู ุญุงุฌุฉ ุชุฑุฌุน ุฒู ูุง ูุงูุช! โ
  return { order, stock, invoice };
});
```

**ุงูุญูุงูุฉ:**
1. **Atomicity**: ูู ุงูุฎุทูุงุช ุชูุฌุญ ุฃู ูููุง ุชุฑุฌุน
2. **Consistency**: ุงูุจูุงูุงุช ุฏุงููุงู ูุชุณูุฉ
3. **Isolation**: ุงูุนูููุงุช ุงููุชุฒุงููุฉ ูุด ุจุชุชุนุงุฑุถ
4. **Durability**: ุงูุจูุงูุงุช ูุญููุธุฉ ุญุชู ูู ุงูุณูุฑูุฑ ููุน

**ุงูููุงุฆุฏ:**
- โ ููุน ููุฏุงู ุงูุจูุงูุงุช
- โ ุถูุงู ุชูุงุณู ุงูุญุงูุฉ
- โ ุญูุงูุฉ ูู Race Conditions
- โ Rollback ุชููุงุฆู ุนูุฏ ุงููุดู

---

## ๐ง ุทุฑููุฉ ุชุดุบูู ุงูุญููู

### ุงููุฑุญูุฉ 1: ุงูุชุญุถูุฑ (ุงุชุนููุช โ)

```bash
# 1. ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูููุชุจุงุช ุงููุทููุจุฉ
npm list zod  # ูุฌุจ ุฃู ุชููู ููุฌูุฏุฉ
```

**ุงููููุงุช ุงูุฌุฏูุฏุฉ ุงููู ุงุชุนููุช:**
```
src/lib/
โโโ errors/
โ   โโโ app-errors.ts           โ ุฃููุงุน ุงูุฃุฎุทุงุก
โ   โโโ error-handler.ts        โ ูุนุงูุฌ ุงูุฃุฎุทุงุก
โโโ validation/
โ   โโโ schemas.ts              โ ููุงุนุฏ ุงูุชุญูู
โ   โโโ stock-validator.ts      โ ุงูุชุญูู ูู ุงููุฎุฒูู
โโโ db/
    โโโ transaction-helper.ts   โ ุงููุนุงููุงุช ุงูุขููุฉ
```

---

### ุงููุฑุญูุฉ 2: ุงูุฏูุฌ ูุน APIs (ุงูุฎุทูุฉ ุงูุฌุงูุฉ)

**ุงููุฏู:** ุฏูุฌ ุงูุญููู ูุน APIs ุงูุญุงููุฉ ุจุฏูู ุชุนุทูู ุงููุธุงู

#### ุฃููุงู: ุฏูุฌ ูุน Orders API

**ุงูุฎุทูุงุช:**
1. ูุชุญ ููู `src/app/api/orders/route.ts`
2. ุงุณุชูุฑุงุฏ ุงูุฃุฏูุงุช ุงูุฌุฏูุฏุฉ
3. ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุจูุงูุงุช
4. ุฅุถุงูุฉ ุงูุชุญูู ูู ุงููุฎุฒูู
5. ุงุณุชุฎุฏุงู ุงููุนุงููุงุช ุงูุขููุฉ

**ูุซุงู ุงูููุฏ:**

```typescript
// ููู: src/app/api/orders/route.ts

import { orderCreateSchema } from '@/lib/validation/schemas';
import { validateStockOrThrow } from '@/lib/validation/stock-validator';
import { runInTransaction } from '@/lib/db/transaction-helper';
import { handleError } from '@/lib/errors/error-handler';

export async function POST(request: Request) {
  try {
    const body = await request.json();
    
    // โ ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
    const validatedData = orderCreateSchema.parse(body);
    
    // โ ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงููุฎุฒูู
    await validateStockOrThrow(validatedData.items);
    
    // โ ุงูุฎุทูุฉ 3: ุฅูุดุงุก Order ูู ูุนุงููุฉ ุขููุฉ
    const result = await runInTransaction(async (client) => {
      // ุฅูุดุงุก Order
      const order = await client.from('orders').insert({
        customer_name: validatedData.customerName,
        total: validatedData.total,
        // ... ุจุงูู ุงูุจูุงูุงุช
      }).select().single();
      
      // ุฎุตู ุงููุฎุฒูู
      for (const item of validatedData.items) {
        await client.from('products')
          .update({ 
            stock: client.raw('stock - ?', [item.quantity]) 
          })
          .eq('id', item.productId);
      }
      
      return order;
    });
    
    return Response.json({
      success: true,
      data: result
    });
    
  } catch (error) {
    // โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุงุญุชุฑุงูู
    return handleError(error);
  }
}
```

**ุงูููุงุฆุฏ ุจุนุฏ ุงูุชุทุจูู:**
- โ ูุณุชุญูู ุฅูุดุงุก Order ุจุฏูู ุจูุงูุงุช ุตุญูุญุฉ
- โ ูุณุชุญูู ุฅูุดุงุก Order ูููุชุฌ ุบูุฑ ูุชููุฑ
- โ ุถูุงู ุชูุงุณู ุงูุจูุงูุงุช (Order + Stock)
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

---

#### ุซุงููุงู: ุฏูุฌ ูุน Products API

**ููุณ ุงูููุฑุฉ:**

```typescript
// ููู: src/app/api/products/route.ts

import { productSchema } from '@/lib/validation/schemas';
import { handleError } from '@/lib/errors/error-handler';

export async function POST(request: Request) {
  try {
    const body = await request.json();
    
    // โ ุงูุชุญูู ูู ุงูุจูุงูุงุช
    const validatedData = productSchema.parse(body);
    
    // ุฅูุดุงุก ุงูููุชุฌ
    const supabase = createServerSupabaseClient();
    const { data, error } = await supabase
      .from('products')
      .insert(validatedData)
      .select()
      .single();
    
    if (error) throw new DatabaseError('ูุดู ุฅูุดุงุก ุงูููุชุฌ', { error });
    
    return Response.json({ success: true, data });
    
  } catch (error) {
    return handleError(error);
  }
}
```

---

### ุงููุฑุญูุฉ 3: ุงูุงุฎุชุจุงุฑ

#### ุงุฎุชุจุงุฑ 1: ุงูุชุญูู ูู ุงูุจูุงูุงุช

```bash
# ุงุฎุชุจุงุฑ: ุฅุฑุณุงู ุจูุงูุงุช ุบูุท
curl -X POST http://localhost:3000/api/orders \
  -H "Content-Type: application/json" \
  -d '{
    "customerName": "",  # โ ูุงุถู
    "phone": "abc"       # โ ููุณ ุฑูู
  }'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# {
#   "success": false,
#   "error": {
#     "message": "ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ",
#     "details": {
#       "customerName": "ุงูุงุณู ูุทููุจ",
#       "phone": "ุฑูู ุงูุชููููู ุบูุฑ ุตุญูุญ"
#     }
#   }
# }
```

#### ุงุฎุชุจุงุฑ 2: ุงูุชุญูู ูู ุงููุฎุฒูู

```bash
# ุงูุณููุงุฑูู: ุทูุจ 100 ูุทุนุฉ ูู ููุชุฌ ูุชููุฑ ููู 5 ููุท

curl -X POST http://localhost:3000/api/orders \
  -H "Content-Type: application/json" \
  -d '{
    "customerName": "ุฃุญูุฏ",
    "items": [
      { "productId": "123", "quantity": 100 }
    ]
  }'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# {
#   "success": false,
#   "error": {
#     "type": "StockError",
#     "message": "ูุฎุฒูู ุบูุฑ ูุงูู",
#     "details": {
#       "errors": [
#         "ุงูููุชุฌ ABC - ูุชููุฑ: 5ุ ูุทููุจ: 100"
#       ]
#     }
#   }
# }
```

#### ุงุฎุชุจุงุฑ 3: Race Conditions

```bash
# ุงูุชุญ 2 Terminal ูุงุนูู ููุณ ุงูุทูุจ ูู ููุณ ุงููุญุธุฉ:

# Terminal 1:
curl -X POST http://localhost:3000/api/orders -d '{"items":[{"productId":"123","quantity":3}]}'

# Terminal 2 (ูู ููุณ ุงูููุช):
curl -X POST http://localhost:3000/api/orders -d '{"items":[{"productId":"123","quantity":3}]}'

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# - ูุงุญุฏ ููุฌุญ โ
# - ุงูุชุงูู ููุดู ูุน ุฑุณุงูุฉ "ูุฎุฒูู ุบูุฑ ูุงูู" โ
```

---

### ุงููุฑุญูุฉ 4: ุงููุฑุงูุจุฉ (Monitoring)

#### ุฅุถุงูุฉ Logging

```typescript
// ููู: src/lib/monitoring/logger.ts

export function logOrder(order: any) {
  console.log({
    timestamp: new Date().toISOString(),
    type: 'ORDER_CREATED',
    orderId: order.id,
    customer: order.customer_name,
    items: order.items.length,
    total: order.total
  });
}

export function logStockUpdate(productId: string, change: number) {
  console.log({
    timestamp: new Date().toISOString(),
    type: 'STOCK_UPDATED',
    productId,
    change,
    remaining: 'check DB' // ุฃู ุงุฌูุจ ุงููููุฉ ุงูุญุงููุฉ
  });
}
```

#### Dashboard ุจุณูุท ูููุฑุงูุจุฉ

ููููู ุฅุถุงูุฉ ุตูุญุฉ ุจุณูุทุฉ ูู ุงูู Admin Panel:

```
/admin/monitoring
- โ ุนุฏุฏ ุงูุฃูุฑุฏุฑุงุช ุงูููู
- โ๏ธ ุนุฏุฏ ุงูุฃุฎุทุงุก ุงูููู
- ๐ฆ ุงูููุชุฌุงุช ุงููู ูุฑุจุช ุชุฎูุต
- ๐ด ุงูุฃุฎุทุงุก ุงูุญุฑุฌุฉ ุงูุฃุฎูุฑุฉ
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุฌุงูุฉ (Next Steps)

### ุฃููููุฉ ุนุงููุฉ (High Priority):

#### 1. ุฏูุฌ ุงูุญููู ูุน Orders API
- [ ] ุชุนุฏูู `src/app/api/orders/route.ts`
- [ ] ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุจูุงูุงุช
- [ ] ุฅุถุงูุฉ ุงูุชุญูู ูู ุงููุฎุฒูู
- [ ] ุงุณุชุฎุฏุงู ุงููุนุงููุงุช ุงูุขููุฉ
- [ ] ุงุฎุชุจุงุฑ ุดุงูู

**ุงูููุช ุงููุชููุน:** 2-3 ุณุงุนุงุช

---

#### 2. ุฏูุฌ ูุน Products API
- [ ] ุชุนุฏูู `src/app/api/products/route.ts`
- [ ] ุฅุถุงูุฉ ุงูุชุญูู ูู ุงูุจูุงูุงุช
- [ ] ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- [ ] ุงุฎุชุจุงุฑ

**ุงูููุช ุงููุชููุน:** 1-2 ุณุงุนุฉ

---

#### 3. ุฅุถุงูุฉ Database Migrations

**ุงููุดููุฉ:** ุจุนุถ ุงูุฌุฏุงูู ูููู ุชุญุชุงุฌ ุฃุนูุฏุฉ ุฌุฏูุฏุฉ

**ุงูุญู:**

```sql
-- ุฅุถุงูุฉ version column ููุญูุงูุฉ ูู Race Conditions
ALTER TABLE orders ADD COLUMN version INTEGER DEFAULT 1;
ALTER TABLE products ADD COLUMN version INTEGER DEFAULT 1;

-- ุฅุถุงูุฉ min_stock_level ููุชุญุฐูุฑุงุช
ALTER TABLE products ADD COLUMN min_stock_level INTEGER DEFAULT 10;

-- ุฅุถุงูุฉ indexes ููุฃุฏุงุก
CREATE INDEX idx_orders_created_at ON orders(created_at);
CREATE INDEX idx_products_stock ON products(stock);
```

**ุงูููุช ุงููุชููุน:** 1 ุณุงุนุฉ

---

### ุฃููููุฉ ูุชูุณุทุฉ (Medium Priority):

#### 4. ูุธุงู Audit Log
- ุชุณุฌูู ูู ุงูุชุบููุฑุงุช ุงููููุฉ
- ูุนุฑูุฉ ููู ุนูู ุฅูู ููุชู

```typescript
// ูุซุงู
await auditLog({
  action: 'ORDER_CREATED',
  userId: user.id,
  resourceType: 'order',
  resourceId: order.id,
  changes: { ... }
});
```

---

#### 5. ูุธุงู Notifications
- ุชูุจูู ุงูุฃุฏูู ููุง ุงููุฎุฒูู ููุฑุจ ูุฎูุต
- ุชูุจูู ุนูุฏ ุญุฏูุซ ุฃุฎุทุงุก ุญุฑุฌุฉ

```typescript
// ูุซุงู
if (product.stock < product.min_stock_level) {
  await sendNotification({
    type: 'LOW_STOCK',
    product: product.name,
    currentStock: product.stock
  });
}
```

---

### ุฃููููุฉ ููุฎูุถุฉ (Low Priority):

#### 6. ุชุญุณููุงุช ุงูุฃุฏุงุก
- Caching ููููุชุฌุงุช
- ุชุญุณูู ุงุณุชุนูุงูุงุช DB
- Pagination ููููุงุฆู ุงูุทูููุฉ

#### 7. Dashboard ูุชูุฏู
- ุฑุณูู ุจูุงููุฉ
- ุชูุงุฑูุฑ ุชูุตูููุฉ
- ุชุญูููุงุช

---

## ๐ ููุงุฑูุฉ: ูุจู ูุจุนุฏ ุงูุญููู

### ุณููุงุฑูู 1: ุฅูุดุงุก Order ุฌุฏูุฏ

| **ุงููุฑุญูุฉ** | **ูุจู ุงูุญููู** | **ุจุนุฏ ุงูุญููู** |
|-------------|----------------|----------------|
| **ุงูุชุญูู ูู ุงูุจูุงูุงุช** | โ ูุง ููุฌุฏ | โ ุชููุงุฆู ูุดุงูู |
| **ุงูุชุญูู ูู ุงููุฎุฒูู** | โ ูุง ููุฌุฏ | โ ูุจู ุฅูุดุงุก ุงูู Order |
| **ุฎุตู ุงููุฎุฒูู** | โ ุจุฏูู ุญูุงูุฉ | โ ูู ูุนุงููุฉ ุขููุฉ |
| **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** | โ ุฑุณุงุฆู ุบุงูุถุฉ | โ ุฑุณุงุฆู ูุงุถุญุฉ |
| **ุงูุฃูุงู** | โ๏ธ ุถุนูู | โ ููู ุฌุฏุงู |
| **ุงูุซุจุงุช** | โ๏ธ ุบูุฑ ูุถููู | โ ูุถููู 100% |

---

### ุณููุงุฑูู 2: ุชุญุฏูุซ ููุชุฌ

| **ุงูุญุงูุฉ** | **ูุจู ุงูุญููู** | **ุจุนุฏ ุงูุญููู** |
|-----------|----------------|----------------|
| **ุงูุจูุงูุงุช ุงูุบูุท** | โ ุชููุจู | โ ุชูุฑูุถ |
| **Race Conditions** | โ๏ธ ููููุฉ | โ ูุญููุฉ |
| **Rollback ุนูุฏ ุงููุดู** | โ ูุง ููุฌุฏ | โ ุชููุงุฆู |
| **ุชุชุจุน ุงูุชุบููุฑุงุช** | โ ุตุนุจ | โ ุณูู |

---

## ๐ ูุตุงุฆุญ ูููุฉ ููุชุทุจูู

### โ ุงูุนู (Do's):

1. **ุงุจุฏุฃ ุชุฏุฑูุฌูุงู**: ุงุดุชุบู ุนูู API ูุงุญุฏ ูู ุงููุฑุฉ
2. **ุงุฎุชุจุฑ ูููุณ**: ุฌุฑุจ ูู ุงูุณููุงุฑูููุงุช ูุจู ุงููุดุฑ
3. **ุฑุงุฌุน ุงูู logs**: ุงุชุงุจุน ุงูุฃุฎุทุงุก ูุงูุชุญุฐูุฑุงุช
4. **ุงุนูู backup**: ูุจู ุฃู ุชุนุฏูู ุนูู ุงูู production
5. **ุงุณุชุฎุฏู staging**: ุฌุฑุจ ุงูุชุนุฏููุงุช ุนูู ุจูุฆุฉ ุชุฌุฑูุจูุฉ ุงูุฃูู

### โ ูุง ุชูุนู (Don'ts):

1. **ูุง ุชุทุจู ูู ุญุงุฌุฉ ูุฑุฉ ูุงุญุฏุฉ**: ูููู ุชูุฎุจุท
2. **ูุง ุชุชุฌุงูู ุงูุชุญุฐูุฑุงุช**: ูููู ุชููู ุฅุดุงุฑุฉ ููุดููุฉ
3. **ูุง ุชูุดุฑ ุจุฏูู ุงุฎุชุจุงุฑ**: ุฎุทุฑ ุนูู ุงูุจูุงูุงุช
4. **ูุง ุชุนุทู Error Handling**: ุถุฑูุฑู ุฌุฏุงู
5. **ูุง ุชูุณู ุงูู monitoring**: ูุงุฒู ุชุนุฑู ุฅูู ุงููู ุจูุญุตู

---

## ๐ ุฌุงูุฒ ููุจุฏุกุ

### ุงูุฎุทูุฉ ุงูุชุงููุฉ:

**ุงุฎุชุงุฑ ูุงุญุฏุฉ:**

#### Option A: ุงุจุฏุฃ ุจุงูุฏูุฌ ูุน Orders API
```bash
# ุณุฃุณุงุนุฏู ูู ุชุนุฏูู ููู Orders API ุฎุทูุฉ ุจุฎุทูุฉ
```

#### Option B: ุงุจุฏุฃ ุจุงูุฏูุฌ ูุน Products API  
```bash
# ุณุฃุณุงุนุฏู ูู ุชุนุฏูู ููู Products API
```

#### Option C: ุงุนูู Database Migrations ุงูุฃูู
```bash
# ุณุฃุณุงุนุฏู ูู ุฅุนุฏุงุฏ ุงูู migrations ุงููุทููุจุฉ
```

#### Option D: ุดูู ุงูุชูุซูู ุงููุงูู
```bash
# ุงูุฑุฃ ุงูุชูุซูู ุงูุชููู ุงูุชูุตููู ุฃููุงู
```

---

## ๐ ูุญุชุงุฌ ูุณุงุนุฏุฉุ

### ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุญููููุง:

#### ูุดููุฉ: "zod is not defined"
**ุงูุญู:**
```bash
npm install zod
# ุฃู
yarn add zod
```

#### ูุดููุฉ: "Cannot find module '@/lib/errors'"
**ุงูุญู:** ุชุฃูุฏ ุฅู ุงููููุงุช ููุฌูุฏุฉ ูู ุงูููุงู ุงูุตุญูุญ:
```
src/lib/errors/app-errors.ts        โ
src/lib/errors/error-handler.ts     โ
```

#### ูุดููุฉ: "Transaction failed"
**ุงูุญู:** ุดูู ุนูู:
1. ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุดุบุงูุ
2. ุงูุจูุงูุงุช ุตุญูุญุฉุ
3. ุงููุณุชุฎุฏู ุนูุฏู ุตูุงุญูุงุชุ

---

## ๐ ููุฎุต ุณุฑูุน (TL;DR)

### ุงููุดุงูู:
- โ ุจูุงูุงุช ุบูุท ุชุฏุฎู ุงููุธุงู
- โ ูุฎุฒูู ุจูุฎูุต ููุญุฏุด ูุงุฎุฏ ุจุงูู
- โ ุฃุฎุทุงุก ุบุงูุถุฉ
- โ ุชุนุงุฑุถุงุช ูู ุงูุจูุงูุงุช

### ุงูุญููู:
- โ ูุธุงู ุชุญูู ุฃูุชููุงุชููู ูู ุงูุจูุงูุงุช (Zod)
- โ ุญูุงูุฉ ุงููุฎุฒูู (Stock Validator)
- โ ุฃุฎุทุงุก ูุงุถุญุฉ (Error Handler)
- โ ูุนุงููุงุช ุขููุฉ (Transactions)

### ุงููุชูุฌุฉ:
- ๐ฏ **ูุธุงู ุฃููู**
- ๐ก๏ธ **ุฃูุซุฑ ุฃูุงูุงู**
- ๐ **ุจูุงูุงุช ููุซููุฉ**
- ๐ช **ุฌุงูุฒ ููุฅูุชุงุฌ**

---

## ๐ ุงูุฎูุงุตุฉ

ุงููุธุงู ุฏูููุชู ุฌุงูุฒ ููุชุทุจูู ุนูู production ุจุนุฏ ุฏูุฌ ุงูุญููู ูุงุฎุชุจุงุฑูุง. ูู ุงููุดุงูู ุงูุญุฑุฌุฉ ุชู ุญููุง ูู ุงูุฌุฐูุฑุ ูุงูุจููุฉ ุงูุชุญุชูุฉ ุฌุงูุฒุฉ.

**ุงูุฎุทูุฉ ุงูุฌุงูุฉ:** ุงุฎุชุงุฑ ูู ุงูู Options ููู ูุงุจุฏุฃ ุงูุชุทุจูู! ๐

---

**ุชู ุจุญูุฏ ุงููู โจ**

> ุฅุฐุง ูุงู ุนูุฏู ุฃู ุงุณุชูุณุงุฑ ุฃู ูุญุชุงุฌ ุชูุถูุญ ุฃูุชุฑ ูู ุฃู ุฌุฒุกุ ุฃูุง ุฌุงูุฒ! ๐ช